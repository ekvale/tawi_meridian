{% load static %}
<nav class="bg-white shadow-lg sticky top-0 z-50">
    <div class="container mx-auto px-4">
        <div class="flex justify-between items-center h-16 md:h-20">
            {# Logo #}
            <div class="flex-shrink-0">
                <a href="{% url 'core:home' %}" class="flex items-center space-x-3 hover:opacity-90 transition-opacity group">
                    <img src="{% static 'images/logo.png' %}" alt="Tawi Meridian Logo" class="logo navbar-logo h-12 md:h-16 w-auto max-w-[220px] md:max-w-[260px] object-contain" id="logo-img" onerror="this.style.display='none'; document.getElementById('logo-text-fallback').classList.remove('hidden');">
                    <span class="font-heading font-bold text-2xl md:text-3xl text-tawi-blue hidden group-hover:text-blue-800 transition-colors" id="logo-text-fallback">Tawi Meridian</span>
                </a>
            </div>
            
            {# Desktop Navigation #}
            <div class="hidden md:flex space-x-6">
                <a href="{% url 'core:home' %}" class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}">Home</a>
                <a href="{% url 'core:about' %}" class="nav-link {% if request.resolver_match.url_name == 'about' %}active{% endif %}">About</a>
                
                {# Services Dropdown #}
                <div class="relative group">
                    <a href="{% url 'services:service_list' %}" class="nav-link {% if 'services' in request.path %}active{% endif %}">
                        Services
                        <svg class="inline-block w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </a>
                    <div class="absolute left-0 mt-2 w-64 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300">
                        <div class="py-2">
                            {% if services %}
                                {% for service in services|slice:":5" %}
                                    {% if service.is_active %}
                                    <a href="{{ service.get_absolute_url }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-tawi-light hover:text-tawi-blue">
                                        {{ service.title }}
                                    </a>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                            <a href="{% url 'services:service_list' %}" class="block px-4 py-2 text-sm font-semibold text-tawi-blue hover:bg-tawi-light">
                                View All Services â†’
                            </a>
                        </div>
                    </div>
                </div>
                
                <a href="{% url 'portfolio:case_study_list' %}" class="nav-link {% if 'portfolio' in request.path %}active{% endif %}">Portfolio</a>
                <a href="{% url 'blog:blog_list' %}" class="nav-link {% if 'insights' in request.path %}active{% endif %}">Insights</a>
                <a href="{% url 'contact:contact' %}" class="nav-link {% if 'contact' in request.path %}active{% endif %}">Contact</a>
            </div>
            
            {# CTA Button / Login #}
            <div class="hidden md:flex items-center space-x-4">
                {% if user.is_authenticated %}
                    <a href="{% url 'business_plan:dashboard' %}" class="text-gray-700 hover:text-tawi-blue font-medium transition-colors">
                        Business Plan
                    </a>
                    <a href="{% url 'project_management:dashboard' %}" class="text-gray-700 hover:text-tawi-blue font-medium transition-colors">
                        Dashboard
                    </a>
                    <a href="{% url 'project_management:logout' %}" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-200 transition-colors">
                        Logout
                    </a>
                {% else %}
                    <a href="{% url 'project_management:login' %}" class="bg-tawi-orange text-white px-6 py-2 rounded-lg font-semibold hover:bg-orange-600 transition-colors">
                        Login
                    </a>
                {% endif %}
            </div>
            
            {# Mobile Menu Button #}
            <button type="button" class="md:hidden p-2 rounded-md text-gray-700 hover:text-tawi-blue hover:bg-gray-100" id="mobile-menu-button">
                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
    </div>
    
            {# Mobile Navigation #}
    <div class="md:hidden hidden" id="mobile-menu">
        <div class="px-2 pt-2 pb-3 space-y-1 bg-white border-t">
            <a href="{% url 'core:home' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">Home</a>
            <a href="{% url 'core:about' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">About</a>
            <a href="{% url 'services:service_list' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">Services</a>
            <a href="{% url 'portfolio:case_study_list' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">Portfolio</a>
            <a href="{% url 'blog:blog_list' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">Insights</a>
            <a href="{% url 'contact:contact' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">Contact</a>
            {% if user.is_authenticated %}
                <div class="border-t border-gray-200 mt-2 pt-2">
                    <a href="{% url 'business_plan:dashboard' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">Business Plan</a>
                    <a href="{% url 'project_management:dashboard' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">Dashboard</a>
                    <a href="{% url 'project_management:logout' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-tawi-blue hover:bg-gray-50">Logout</a>
                </div>
            {% endif %}
        </div>
    </div>
</nav>

<style>
    .nav-link {
        @apply text-gray-700 hover:text-tawi-blue font-medium transition-colors px-3 py-2;
    }
    .nav-link.active {
        @apply text-tawi-blue border-b-2 border-tawi-orange;
    }
</style>

<script>
    // Mobile menu toggle
    document.getElementById('mobile-menu-button')?.addEventListener('click', function() {
        const menu = document.getElementById('mobile-menu');
        menu?.classList.toggle('hidden');
    });
</script>
